---
import type { GetStaticPaths } from "astro";
import api from "@/services/api";
import Layout from "src/layouts/Layout.astro";
import { Image } from "astro:assets";
import HeartFilled from "@/assets/line-md--heart-filled.svg";
import Heart from "@/assets/line-md--heart.svg";

export const getStaticPaths = (async () => {
  const [error, data] = await api.getPlayers();
  if (error) throw new Error("Error al pedir los jugadores");

  const { response } = data;

  return response.map(({ player }) => {
    return { params: { id: player.id }, props: { ...player } };
  });
}) satisfies GetStaticPaths;

const { id } = Astro.params;
const { name, photo } = Astro.props;
---

<Layout title={name}>
  <section class="mt-10 mx-10 flex flex-col justify-center items-center">
    <header>
      <button onclick="history.back()" class="text-blue-500 align-top"
        >Regresar</button
      >
      <button id="btn-favorite" class="ml-4 hover:animate-pulse">
        <Heart />
        <HeartFilled class="hidden" />
      </button>
    </header>
    <div>
      <h1 class="text-5xl mb-4 capitalize">{name}</h1>
      <Image
        transition:name={`${id}-image`}
        class="mx-auto"
        src={photo}
        alt={`Profile photo of ${name}`}
        height={150}
        width={150}
      />
    </div>
  </section>
</Layout>
